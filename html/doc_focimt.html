
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>focimt</title><meta name="generator" content="MATLAB 8.6"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2016-09-22"><meta name="DC.source" content="doc_focimt.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>focimt</h1><!--introduction--><p>Perform seismic moment tensor inversion in time domain.</p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Syntax</a></li><li><a href="#2">Description</a></li><li><a href="#6">Additional information</a></li><li><a href="#7">Parameters</a></li><li><a href="#95">Examples</a></li><li><a href="#116">See also</a></li></ul></div><h2>Syntax<a name="1"></a></h2><pre class="language-matlab">focimt(Input)
focimt(Input,<span class="string">'PropertyName'</span>,PropertyValue, <span class="keyword">...</span><span class="comment">)</span>
[Solution, Input] = focimt(<span class="keyword">...</span><span class="comment">)</span>
</pre><h2>Description<a name="2"></a></h2><p>Use <tt>focimt</tt> to perform the seismic moment tensor inversion using fociMT application via MATLAB interface. The function wraps the input and output of data for fociMT executable and provide a convenient interface between MATLAB and fociMT application.</p><p><tt>focimt(Input)</tt> reads input data and performs moment tensor inversion using fociMT software and default processing parameters. The input array can be either a path to the formatted ASCII input file or Input cell array.</p><p><tt>focimt(Input,'PropertyName',PropertyValue, ...)</tt> allows to specify additional parameters in a form of PropertyName-PropertyValue pairs.</p><p><tt>[Solution, Input] = focimt(...)</tt> returns final moment tensor solutions in a form of cell array <tt>Solution</tt> as well as input cell array <tt>Input</tt>.</p><h2>Additional information<a name="6"></a></h2><p>For an up-to-date information on software package, see the following website: <a href="http://www.induced.pl/focimt">http://www.induced.pl/focimt</a>.</p><h2>Parameters<a name="7"></a></h2><p><b>BeachBallSize</b> - Beach ball figure size</p><p><tt>500</tt> (default) | scalar value</p><p>Defines size of graphical representation of seismic moment tensor solution exported by fociMT software in arbitrary units. For raster formats the value corresponds to pixels.</p><p><b>BeachBallFormat</b> - Beach ball figure file format</p><p><tt>'NONE'</tt> (default) | <tt>'PNG'</tt> | <tt>'SVG'</tt> | <tt>'PDF'</tt> | <tt>'PS'</tt></p><p>Defines format of graphical representation of the seismic moment tensor file (beach ball). By default, no output file is exported. Multiple file formats can be specified by appending the comma or any other delimiter, e.g. 'PNG,SVG,PS' parameter value will export beach balls in three different file formats at once.</p><p><b>CorrectStation</b> - Allows to provide a constant multiplier factor to input amplitudes</p><p><tt>cell([])</tt> (default) | {'stationname1',factor1,'stationname2',factor2,...}</p><p>Allows to provide a constant multiplication factor to input seismic moments for a specific station or stations. This can be useful when one want to correct a specific station for bad polarity or bad gain value. Also, this parameter is useful while performing the hybrid moment tensor inversion with corrected gains.</p><p><b>Decomposition</b> - Method used for seismic moment tensor decomposition</p><p><tt>'JostHerrmann'</tt> (default) | <tt>'Vavrycuk'</tt></p><p>By default the output structure array contains moment tensor decomposition into ISO, CLVD and DC parts following Jost and Herrmann approach. The alternative method for moment tensor decomposition following Vavrycuk's (2001) approach may be used instead.</p><p><b>DoubleCoupleColor</b> - Color of best double-couple line</p><p><tt>1-by-3 vector [R G B]</tt> | <tt>1-by-4 vector [R G B A]</tt></p><p>Determines color of double-couple line for the best solution. The color vector may be provided either as <tt>1-by-3</tt> element vector containty R, G, B intensities (with 0.0 and 1.0 denoting no and full color component intensity, respectively). The alternative option is to provide <tt>1-by-4</tt> element vector where the fourth parameter determines the color transparency (0.0 - full transparent, 1.0 - opaque).</p><p><b>DrawSolution</b> - Plot focal mechanism or moment tensor solution</p><p><tt>empty vector</tt> (default) | <tt>1-by-3 element vector</tt> | <tt>1-by-6 element vector</tt></p><p>Draw seismic moment tensor solution as a beach ball and exits program. The mechanism can be specified as <tt>1-by-3 element vector</tt> containing strike, dip and rake of the fault plane in degrees. Alternatively, the User may provide <tt>1-by-6 element vector</tt> which will be interpreted as moment tensor components following AKI convention: <tt>[M11 M12 M13 M22 M23 M33]</tt>. The beach ball will be generated as PNG image.</p><p><b>IgnoreStation</b> - Ignored station(s) list</p><p><tt>{}</tt> (default) | cell array | string</p><p>Use this parameter to specify a list of stations that should be rejected from seismic moment tensor inversion. Single station can be specified as string. If multiple stations are meant to be rejected they must be provided as cell array of strings.</p><p><b>Jacknife</b> - Perform station rejection test</p><p><tt>'off'</tt> (default) | <tt>'on'</tt></p><p>Performs station rejection 'Jacknife' test. In this procedure in the first step the seismic moment tensor inversion is performed using all available stations. Then, the inversion is performed <i>n</i> more times (where <i>n</i> is the number of stations), and each time different station is removed before inversion is performed. See <i>Examples</i> section for details.</p><p><b>Hemisphere</b> - Hemisphere projection</p><p><tt>'lower'</tt> (default) | <tt>'upper'</tt></p><p>Allows to specify whether the obtained fault plane solution is projected onto <tt>'lower'</tt> or <tt>'upper'</tt> part of the hemisphere in graphical representation of the seismic moment tensor solution (beach ball). Seismological convention, and the default value of this parameter is lower hemisphere projection.</p><p><b>LabelColor</b> - Color of station labels</p><p><tt>1-by-3 vector [R G B]</tt> | <tt>1-by-4 vector [R G B A]</tt></p><p>Determines color of station labels. The color vector may be provided either as <tt>1-by-3</tt> element vector containty R, G, B intensities (with 0.0 and 1.0 denoting no and full color component intensity, respectively). The alternative option is to provide <tt>1-by-4</tt> element vector where the fourth parameter determines the color transparency (0.0 - full transparent, 1.0 - opaque).</p><p><b>MinimumPhases</b> - Minimum number of phases to calculate moment tensor solution</p><p><tt>8</tt> (default) | scalar value &gt; 0</p><p>Specifies minimum number of phases to perform the moment tensor inversion.</p><p><b>MinusColor</b> - Color of negative station amplitudes</p><p><tt>1-by-3 vector [R G B]</tt> | <tt>1-by-4 vector [R G B A]</tt></p><p>Determines color of negative station amplitudes. The color vector may be provided either as <tt>1-by-3</tt> element vector containty R, G, B intensities (with 0.0 and 1.0 denoting no and full color component intensity, respectively). The alternative option is to provide <tt>1-by-4</tt> element vector where the fourth parameter determines the color transparency (0.0 - full transparent, 1.0 - opaque).</p><p><b>Norm</b> - Optimization norm</p><p><tt>'L2'</tt> (default) | <tt>'L1'</tt></p><p>Defines norm of the cost function as well as the algorithm that is used to perform the seismic moment tensor inversion with fociMT software. By default the seismic moment tensor is performed using <i>L2</i> norm (faster). However, if input data contains large amplitude misreadings, the user can choose <i>L1</i> norm which is less prone to larger errors.</p><p><b>NormalFaultColor</b> - Color of double-couple line for normal fault</p><p><tt>1-by-3 vector [R G B]</tt> | <tt>1-by-4 vector [R G B A]</tt></p><p>Determines color of double-couple lines for normal fault. The color vector may be provided either as <tt>1-by-3</tt> element vector containty R, G, B intensities (with 0.0 and 1.0 denoting no and full color component intensity, respectively). The alternative option is to provide <tt>1-by-4</tt> element vector where the fourth parameter determines the color transparency (0.0 - full transparent, 1.0 - opaque).</p><p><b>PShadingColor</b> - Color of compression axis shading</p><p><tt>1-by-3 vector [R G B]</tt> | <tt>1-by-4 vector [R G B A]</tt></p><p>Determines color of compression axis shading. The color vector may be provided either as <tt>1-by-3</tt> element vector containty R, G, B intensities (with 0.0 and 1.0 denoting no and full color component intensity, respectively). The alternative option is to provide <tt>1-by-4</tt> element vector where the fourth parameter determines the color transparency (0.0 - full transparent, 1.0 - opaque).</p><p><b>PlotAxes</b> - Axes plotting on the beach ball.</p><p><tt>'off'</tt> (default) | <tt>'on'</tt></p><p>Toggle on/off plotting cardinal P/T axes on graphical representation of the seismic moment tensor.</p><p><b>PlotCross</b> - Center cross plotting on the beach ball.</p><p><tt>'off'</tt> (default) | <tt>'on'</tt></p><p>Toggle on/off plotting of the center cross on graphical representation of the seismic moment tensor.</p><p><b>PlotDC</b> - Nodal lines plotting on the beach ball.</p><p><tt>'off'</tt> (default) | <tt>'on'</tt></p><p>Toggle on/off plotting of the nodal lines on graphical representation of the seismic moment tensor.</p><p><b>PlotStations</b> - Stations plotting on the beach ball.</p><p><tt>'off'</tt> (default) | <tt>'on'</tt></p><p>Toggle on/off plotting stations on graphical representation of the seismic moment tensor.</p><p><b>PlusColor</b> - Color of positive station amplitudes</p><p><tt>1-by-3 vector [R G B]</tt> | <tt>1-by-4 vector [R G B A]</tt></p><p>Determines color of positive station amplitudes. The color vector may be provided either as <tt>1-by-3</tt> element vector containty R, G, B intensities (with 0.0 and 1.0 denoting no and full color component intensity, respectively). The alternative option is to provide <tt>1-by-4</tt> element vector where the fourth parameter determines the color transparency (0.0 - full transparent, 1.0 - opaque).</p><p><b>Projection</b> - Projection type</p><p><tt>'schmidt'</tt> (default) | <tt>'wullf'</tt></p><p>Defines projection type for graphical representation of the seismic moment tensor inversion (beach ball). The user may use <tt>'schmidt'</tt> (equal area) or <tt>'wullf'</tt> (equal angle) projection to plot the beach ball.</p><p><b>ProjectDir</b> - Specify output project directory</p><p><tt>''</tt> (default) | 'directoryname' (valid directory name)</p><p>Use <b>ProjectDir</b> to specify output directory for text files, graphical representations of moment tensor inversion and other files. Also, the input data table (if exists) is copied to this directory after the inversion.</p><p><b>Resample</b> - Perform additional moment tensor inversions using resampled input datasets</p><p><tt>[]</tt> (empty array) | <tt>1-by-2</tt> or <tt>1-by-3</tt> or <tt>1-by-4</tt> or <tt>1-by-5</tt> element vector <tt>V</tt></p><p>The first element <tt>V(1)</tt> of vector <tt>V</tt> specified the number of resamplings of the original input phase dataset. The input data will be randomly resampled <tt>N</tt> times and the inversion will be performed for all randomly resampled datasets as well as for the original dataset. This will then result in <tt>N+1</tt> moment tensor inversion solutions with the first solution calculated from the unperturbed original dataset and the following solutions calculated from resampled datasets.</p><p>When <tt>V(2)</tt> is greater than <tt>0</tt>, on average <tt>V(2)*100%</tt> input phase data polarities will be <i>reversed</i> (equivalent of <tt>-rp</tt> option in <tt>focimt</tt> command line application). The typical value of <tt>V(2)</tt> is e.g. 0.03 (which means about 3% of input phase data polarities will be reversed).</p><p>When <tt>V(3)</tt> is greater than <tt>0</tt>, on average <tt>V(3)*100%</tt> input phase data will be <i>removed</i> (equivalent of <tt>-rr</tt> option in <tt>focimt</tt> command line application). This option is somehow similar to the <b>Jacknife Test</b>, however now more than one station may be removed from input phase data, as it is controlled by the <tt>V(3)</tt> parameter. For example, if one want to asses how the removal of up to 5% of input phase data affects the moment tensor inversion results, the value of <tt>V(3)</tt> should be 0.05.</p><p>When <tt>V(4)</tt> value is greater than <tt>0</tt>, all input amplitudes in resampled input phase data will be randomly perturbed. Each amplitude of resampled input data is modified using the following formula: <img src="doc_focimt_eq01269927772122169200.png" alt="$U_i = U_i + N(0,1)*V(4)/3.0$" style="width:182px;height:16px;">, where N(0,1) means a random sample drawn from the Gaussian distribution of mean <tt>0</tt> and standard deviation <tt>1</tt>. Note that the random number drawn is scaled by a constant factor of 3.0. The option is equivalent to <tt>-ra</tt> option in <tt>focimt</tt> application.</p><p>Finally, when <tt>V(5)</tt> parameter is larger than <tt>0</tt>, the input takeoff angle data will be randomly biased. Similarly to the <i>Amplitude Resampling</i>, the takeoff angle of each phase is modified using the following formula: <img src="doc_focimt_eq06701669830085106152.png" alt="$t_i = t_i + N(0,1)*V(5)/3.0$" style="width:173px;height:16px;">, where N(0,1) means a random sample drawn from Gaussian distribution of mean <tt>0</tt> and standard deviation <tt>1</tt>. The takeoff angle resampling may be used to simulate the uncertainties in the velocity model. The typical values should not exceed a couple of degrees.</p><p><b>Solutions</b> - Type of seismic moment tensor inversions to perform</p><p><tt>'FTD'</tt> (default) | <tt>'F'</tt> | <tt>'T'</tt> | <tt>'D'</tt> | <tt>'FT'</tt> | <tt>'TD'</tt> | <tt>'FD'</tt></p><p>By default, three types of seismic moment tensors are calculated: 1) full (unconstrained) moment tensor (character 'F'), deviatoric moment tensor (character 'T') with no volumentric change (i.e. trace = 0) and double-couple constrained seismic moment tensor (character 'D'), where both trace and determinant of the tensor are 0. The user may wish to constrain the output tensors to only selected MT types to reduce the amount of output data.</p><p><b>StrikeSlipFaultColor</b> - Color of double-couple line for strike-slip fault</p><p><tt>1-by-3 vector [R G B]</tt> | <tt>1-by-4 vector [R G B A]</tt></p><p>Determines color of double-couple lines for strike slip fault. The color vector may be provided either as <tt>1-by-3</tt> element vector containty R, G, B intensities (with 0.0 and 1.0 denoting no and full color component intensity, respectively). The alternative option is to provide <tt>1-by-4</tt> element vector where the fourth parameter determines the color transparency (0.0 - full transparent, 1.0 - opaque).</p><p><b>ThrustFaultColor</b> - Color of double-couple line for thrust fault</p><p><tt>1-by-3 vector [R G B]</tt> | <tt>1-by-4 vector [R G B A]</tt></p><p>Determines color of double-couple lines for thrust fault. The color vector may be provided either as <tt>1-by-3</tt> element vector containty R, G, B intensities (with 0.0 and 1.0 denoting no and full color component intensity, respectively). The alternative option is to provide <tt>1-by-4</tt> element vector where the fourth parameter determines the color transparency (0.0 - full transparent, 1.0 - opaque).</p><p><b>TShadingColor</b> - Color of tension axis shading</p><p><tt>1-by-3 vector [R G B]</tt> | <tt>1-by-4 vector [R G B A]</tt></p><p>Determines color of tension axis shading. The color vector may be provided either as <tt>1-by-3</tt> element vector containty R, G, B intensities (with 0.0 and 1.0 denoting no and full color component intensity, respectively). The alternative option is to provide <tt>1-by-4</tt> element vector where the fourth parameter determines the color transparency (0.0 - full transparent, 1.0 - opaque).</p><p><b>VelocityModel</b> - Input 1D velocity model</p><p><tt>[]</tt> (default) | <tt>n-by-2 matrix</tt></p><p>Allows to provide a 1D velocity model as <tt>n-by-2</tt> matrix where first column corresponds to tops of the lateyers (km) and second column reflects layers' widths (km/s). When this parameter is specified it is assumed the input file is provided in 1D velocity model format.</p><p><b>Verbose</b> - Display additional output in console window</p><p><tt>'off'</tt> (default) | <tt>'on'</tt></p><p>Turns on/off the display of additional processing information in console window.</p><h2>Examples<a name="95"></a></h2><p><b>Example 1</b></p><p>Use sample input fociMT file <tt>example1.txt</tt> and perform the seismic moment tensor inversion using default parameters. Then we gather the output data and input data in two cell array structures:</p><pre class="codeinput">[Output, Input] = focimt(<span class="string">'./examples/example1.txt'</span>);
Input
Output
</pre><pre class="codeoutput">
Input = 

    [1x1 struct]


Output = 

    [1x1 struct]

</pre><p>As the input data contains single seismic event, both <tt>Output</tt> and <tt>Input</tt> are cell arrays with only one element corresponding to the processed seismic event. To see the particular seismic moment tensor solution from the particular seismic events, use cell indexing access:</p><pre class="codeinput">Output{1}
</pre><pre class="codeoutput">
ans = 

          event_id: 'example1_ev01'
          n_trials: 1
    calculation_dt: 7.3660e+05
              full: [1x1 struct]
        deviatoric: [1x1 struct]
                dc: [1x1 struct]

</pre><p>The seismic moment tensor solution for a particular event contains in fact three types of seismic moment tensors: the full moment tensor, the deviatoric (trace-null) moment tensor and the double-couple moment tensor. They can be accessible by inspecting <tt>full</tt>, <tt>clvd</tt> and <tt>dc</tt> structures, of the cell array element. For example, to see the full moment tensor inversion result, you have to access:</p><pre class="codeinput">Output{1}.full
</pre><pre class="codeoutput">
ans = 

          Type: {'N'}
    STATION_ID: 0
           ISO: 5.6167
          CLVD: 17.5724
            DC: 76.8109
            M0: 1.3183e+12
            MT: 1.3322e+12
      M0ERRMAX: 5.7314e+10
            MW: 2.0500
             P: [350.5200 72.6106]
             T: [215.4180 12.5082]
             B: [122.7420 11.8848]
            F1: [115.3490 58.5574 -103.9690]
            F2: [320.8430 34.1130 -68.4559]
         Fault: {'NF'}
           MXX: [1x6 double]
           CXX: [1x6 double]
      RMSERROR: 0.4308
       Station: {1x21 cell}
     UMEASURED: [1x21 double]
           UTH: [1x21 double]

</pre><p>The input data originally available inside input file <tt>example1.txt</tt> are interpreted internally in <tt>focimt.m</tt> function and are returned in the second output parameter of the routine:</p><pre class="codeinput">Input{1}
</pre><pre class="codeoutput">
ans = 

      event_id: 'example1_ev01'
      n_phases: 21
        format: 'raw'
    matrixmode: 1
       Station: {21x1 cell}
     Component: {21x1 cell}
         Phase: {21x1 cell}
         OMEGA: [21x1 double]
       AZIMUTH: [21x1 double]
           AOI: [21x1 double]
       TAKEOFF: [21x1 double]
             V: [21x1 double]
             R: [21x1 double]
       DENSITY: [21x1 double]

</pre><p><b>Example 2</b></p><p>We can create a graphical representation of the seismic moment tensor in a form of a beach ball plot. In this case, we have to execute <tt><a href="doc_focimt.html">focimt.m</a></tt> routine with additional properties. For example, the following code will perform the moment tensor inversion and three pictures in PNG format will be generated:</p><pre class="codeinput">focimt(<span class="string">'./examples/example1.txt'</span>,<span class="string">'BeachBallFormat'</span>,<span class="string">'PNG'</span>);
</pre><p>The code above produce three pictures, one for each type of moment tensor solution:</p><p><img vspace="5" hspace="5" src="example1_ev01-full.png" alt=""> </p><p><img vspace="5" hspace="5" src="example1_ev01-deviatoric.png" alt=""> </p><p><img vspace="5" hspace="5" src="example1_ev01-dc.png" alt=""> </p><p>The available formats are PNG, PDF, PS and SVG. The graphical representation of the moment tensor solution can be customized using different properties: Use <i>BeachBallSize</i> property to generate the picture of the certain size. The <i>Projection</i> parameter controls the type of stereonet projection (either equal area or equal angle projections is available). Finally, the <i>Hemisphere</i> parameters allows to choose between lower (default) or upper hemisphere projection. a beach. You can combine the properties to obtain the desired figure shape. For example:</p><pre class="codeinput">focimt(<span class="string">'./examples/example1.txt'</span>,<span class="string">'BeachBallFormat'</span>,<span class="string">'PDF'</span>,<span class="string">'Projection'</span>,<span class="string">'wullf'</span>,<span class="string">'Hemisphere'</span>,<span class="string">'upper'</span>);
</pre><p>will produce the upper hemisphere equal-angle stereonet projection of the seismic moment tensor solution in PDF format.</p><p><b>Example 3</b></p><p>In this example we perform the seismic moment tensor inversion of two events using Jacknife test to check the stability of both inversions. We export the solution to SVG files and slightly modify the output figure size. Note that the SVG vector format is a convenient way to present your results on web pages, as nowadays it is supported by all web browsers:</p><pre class="codeinput">focimt(<span class="string">'./examples/example2_raw.txt'</span>,<span class="string">'BeachBallFormat'</span>,<span class="string">'SVG'</span>,<span class="string">'BeachBallSize'</span>,250,<span class="string">'Jacknife'</span>,<span class="string">'on'</span>);
</pre><p>The resulting graphical representation of the seismic moment tensor inversion solutions for the first seismic event look as follows:</p><p><img vspace="5" hspace="5" src="344_014_+165-full.svg" alt=""> </p><p><img vspace="5" hspace="5" src="344_014_+165-deviatoric.svg" alt=""> </p><p><img vspace="5" hspace="5" src="344_014_+165-dc.svg" alt=""> </p><p>The first seismic moment tensor solution corresponds to the uncostrained (full) moment tensor. The second solution presents the seismic moment tensor that was constrained to not to have the volumetric changes (i.e. the trace of the tensor was forced to be 0 during inversion). This solution correspond to the seismic moment tensor containing only CLVD (compensated linear vector dipole) and DC (double-couple) components. Finally, the last figure presents the DC constrained moment tensor (the determinant and trace of the tensor is kept to be null during inversion).</p><p>The resulting focal mechanisms contains additional nodal lines. Each line corresponds to a different moment tensor solution calculated using input data will all but one station. Therefore, in addition to the original seismic moment tensor solution, there is <tt>N</tt> more nodal lines where <tt>N</tt> is the number of stations (or phases) picked.</p><p>The Jacknife test is useful to determine whether removal of a particular station strongly affects the seismic moment tensor inversion results. In this case, the particular Jacknife solution will likely differ significantly from the remaining ones. This can be a useful test to detect bad stations.</p><p><b>Example 4</b></p><p>We perform the moment tensor inversion using the built-in 1D velocity model ray-tracer. When 1D velocity model and 1D ray-tracer is used, the input data must be provided using different file format. We firstly define the velocity model:</p><pre class="codeinput">VMODEL = [0.00 3.00 8.00 20.00 22.00; 4.10 5.47 5.75 6.02 7.90]';
</pre><p>The velocity model matrix is composed of two colums. The elements in the first column correspond to layer tops (in km) and the elements from the second column to P-wave velocity (km/s). Once we have the velocity model, we can perform the moment tensor inversion:</p><pre class="codeinput">focimt(<span class="string">'./examples/example2_1d.txt'</span>,<span class="string">'BeachBallFormat'</span>,<span class="string">'PNG'</span>,<span class="string">'BeachBallSize'</span>,250,<span class="string">'VelocityModel'</span>,VMODEL);
</pre><p>As the input phase data were the same as in example 3 (only the input format has changed), the resulting moment tensor solutions are identical:</p><p><img vspace="5" hspace="5" src="344_014_+165-full.png" alt=""> </p><p><img vspace="5" hspace="5" src="344_014_+165-deviatoric.png" alt=""> </p><p><img vspace="5" hspace="5" src="344_014_+165-dc.png" alt=""> </p><h2>See also<a name="116"></a></h2><p><tt><a href="doc_hybridmt.html">hybridmt</a></tt> | <tt><a href="doc_readraw.html">readraw</a></tt> | <tt><a href="doc_readvel1d.html">readvel1d</a></tt> | <tt><a href="matlab:doc('genmt_raw')">genmt_raw</a></tt> | <tt><a href="matlab:doc('genmt_vel1d')">genmt_vel1d</a></tt></p><p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2015b</a><br></p></div><!--
##### SOURCE BEGIN #####
%% focimt
% Perform seismic moment tensor inversion in time domain.
%% Syntax
%   focimt(Input)
%   focimt(Input,'PropertyName',PropertyValue, ...)
%   [Solution, Input] = focimt(...)
%
%% Description
% Use |focimt| to perform the seismic moment tensor inversion using fociMT
% application via MATLAB interface. The function wraps the input and output of
% data for fociMT executable and provide a convenient interface between
% MATLAB and fociMT application.
%%
% |focimt(Input)| reads input data and performs moment tensor inversion using
% fociMT software and default processing parameters. The input array can 
% be either a path to the formatted ASCII input file or Input cell array.
%%
% |focimt(Input,'PropertyName',PropertyValue, ...)| allows to specify 
% additional parameters in a form of PropertyName-PropertyValue pairs.
%%
% |[Solution, Input] = focimt(...)| returns final moment tensor solutions
% in a form of cell array |Solution| as well as input cell array |Input|.
%% Additional information
% For an up-to-date information on software package, see the following website: 
% <http://www.induced.pl/focimt>.
%% Parameters
%%
% *BeachBallSize* - Beach ball figure size 
%%
% |500| (default) | scalar value
%%
% Defines size of graphical representation of seismic moment tensor
% solution exported by fociMT software in arbitrary units. For raster
% formats the value corresponds to pixels.
%%
% *BeachBallFormat* - Beach ball figure file format 
%%
% |'NONE'| (default) | |'PNG'| | |'SVG'| | |'PDF'| | |'PS'|
%%
% Defines format of graphical representation of the seismic moment tensor
% file (beach ball). By default, no output file is exported. Multiple file
% formats can be specified by appending the comma or any other delimiter,
% e.g. 'PNG,SVG,PS' parameter value will export beach balls in three
% different file formats at once.
%% 
% *CorrectStation* - Allows to provide a constant multiplier factor to input amplitudes
%%
% |cell([])| (default) | {'stationname1',factor1,'stationname2',factor2,...}
%%
% Allows to provide a constant multiplication factor to input seismic moments
% for a specific station or stations. This can be useful when one want to
% correct a specific station for bad polarity or bad gain value. Also, this
% parameter is useful while performing the hybrid moment tensor inversion with
% corrected gains.
%
%%
% *Decomposition* - Method used for seismic moment tensor decomposition
%%
% |'JostHerrmann'| (default) | |'Vavrycuk'|
%%
% By default the output structure array contains moment tensor decomposition 
% into ISO, CLVD and DC parts following Jost and Herrmann approach. The 
% alternative method for moment tensor decomposition following Vavrycuk's (2001)
% approach may be used instead.
%%
% *DoubleCoupleColor* - Color of best double-couple line
%%
% |1-by-3 vector [R G B]| | |1-by-4 vector [R G B A]|
%%
% Determines color of double-couple line for the best solution. 
% The color vector may be provided either as |1-by-3| element vector containty
% R, G, B intensities (with 0.0 and 1.0 denoting no and full color component 
% intensity, respectively). The alternative option is to provide |1-by-4| 
% element vector where the fourth parameter determines the color 
% transparency (0.0 - full transparent, 1.0 - opaque).
%% 
% *DrawSolution* - Plot focal mechanism or moment tensor solution
%% 
% |empty vector| (default) | |1-by-3 element vector| | |1-by-6 element vector|
%%
% Draw seismic moment tensor solution as a beach ball and exits program. The 
% mechanism can be specified as |1-by-3 element vector| containing strike, dip
% and rake of the fault plane in degrees. Alternatively, the User may provide
% |1-by-6 element vector| which will be interpreted as moment tensor components
% following AKI convention: |[M11 M12 M13 M22 M23 M33]|. The beach ball will be 
% generated as PNG image.
%%
% *IgnoreStation* - Ignored station(s) list 
%%
% |{}| (default) | cell array | string
%%
% Use this parameter to specify a list of stations that should be rejected
% from seismic moment tensor inversion. Single station can be specified as
% string. If multiple stations are meant to be rejected they must be
% provided as cell array of strings.
%%
% *Jacknife* - Perform station rejection test 
%%
% |'off'| (default) | |'on'|
%%
% Performs station rejection 'Jacknife' test. In this procedure in the first step 
% the seismic moment tensor inversion is performed using all available stations. 
% Then, the inversion is performed _n_ more times (where _n_ is the number of stations), 
% and each time different station is removed before inversion is performed. 
% See _Examples_ section for details.
%%
% *Hemisphere* - Hemisphere projection 
%%
% |'lower'| (default) | |'upper'|
%%
% Allows to specify whether the obtained fault plane solution is projected
% onto |'lower'| or |'upper'| part of the hemisphere in graphical representation
% of the seismic moment tensor solution (beach ball). Seismological convention, 
% and the default value of this parameter is lower hemisphere projection.
%%
% *LabelColor* - Color of station labels
%%
% |1-by-3 vector [R G B]| | |1-by-4 vector [R G B A]|
%%
% Determines color of station labels. 
% The color vector may be provided either as |1-by-3| element vector containty
% R, G, B intensities (with 0.0 and 1.0 denoting no and full color component 
% intensity, respectively). The alternative option is to provide |1-by-4| 
% element vector where the fourth parameter determines the color 
% transparency (0.0 - full transparent, 1.0 - opaque).
%%
% *MinimumPhases* - Minimum number of phases to calculate moment tensor solution 
%%
% |8| (default) | scalar value > 0
%%
% Specifies minimum number of phases to perform the moment tensor
% inversion.
%
%%
% *MinusColor* - Color of negative station amplitudes
%%
% |1-by-3 vector [R G B]| | |1-by-4 vector [R G B A]|
%%
% Determines color of negative station amplitudes. 
% The color vector may be provided either as |1-by-3| element vector containty
% R, G, B intensities (with 0.0 and 1.0 denoting no and full color component 
% intensity, respectively). The alternative option is to provide |1-by-4| 
% element vector where the fourth parameter determines the color 
% transparency (0.0 - full transparent, 1.0 - opaque).
%%
% *Norm* - Optimization norm 
%%
% |'L2'| (default) | |'L1'|
%%
% Defines norm of the cost function as well as the algorithm that is used
% to perform the seismic moment tensor inversion with fociMT software. By
% default the seismic moment tensor is performed using _L2_ norm (faster).
% However, if input data contains large amplitude misreadings, the user can
% choose _L1_ norm which is less prone to larger errors.
%%
% *NormalFaultColor* - Color of double-couple line for normal fault
%%
% |1-by-3 vector [R G B]| | |1-by-4 vector [R G B A]|
%%
% Determines color of double-couple lines for normal fault. 
% The color vector may be provided either as |1-by-3| element vector containty
% R, G, B intensities (with 0.0 and 1.0 denoting no and full color component 
% intensity, respectively). The alternative option is to provide |1-by-4| 
% element vector where the fourth parameter determines the color 
% transparency (0.0 - full transparent, 1.0 - opaque).
%%
% *PShadingColor* - Color of compression axis shading
%%
% |1-by-3 vector [R G B]| | |1-by-4 vector [R G B A]|
%%
% Determines color of compression axis shading. 
% The color vector may be provided either as |1-by-3| element vector containty
% R, G, B intensities (with 0.0 and 1.0 denoting no and full color component 
% intensity, respectively). The alternative option is to provide |1-by-4| 
% element vector where the fourth parameter determines the color 
% transparency (0.0 - full transparent, 1.0 - opaque).
%% 
% *PlotAxes* - Axes plotting on the beach ball.
%%
% |'off'| (default) | |'on'|
%%
% Toggle on/off plotting cardinal P/T axes on graphical representation of the seismic 
% moment tensor.
%% 
% *PlotCross* - Center cross plotting on the beach ball.
%%
% |'off'| (default) | |'on'|
%%
% Toggle on/off plotting of the center cross on graphical representation of the seismic 
% moment tensor.
%% 
% *PlotDC* - Nodal lines plotting on the beach ball.
%%
% |'off'| (default) | |'on'|
%%
% Toggle on/off plotting of the nodal lines on graphical representation of the seismic 
% moment tensor.
%% 
% *PlotStations* - Stations plotting on the beach ball.
%%
% |'off'| (default) | |'on'|
%%
% Toggle on/off plotting stations on graphical representation of the seismic 
% moment tensor.
%%
% *PlusColor* - Color of positive station amplitudes
%%
% |1-by-3 vector [R G B]| | |1-by-4 vector [R G B A]|
%%
% Determines color of positive station amplitudes. 
% The color vector may be provided either as |1-by-3| element vector containty
% R, G, B intensities (with 0.0 and 1.0 denoting no and full color component 
% intensity, respectively). The alternative option is to provide |1-by-4| 
% element vector where the fourth parameter determines the color 
% transparency (0.0 - full transparent, 1.0 - opaque).
%%
% *Projection* - Projection type
%%
% |'schmidt'| (default) | |'wullf'|
%%
% Defines projection type for graphical representation of the seismic
% moment tensor inversion (beach ball). The user may use |'schmidt'| (equal 
% area) or |'wullf'| (equal angle) projection to plot the beach ball. 
%%
% *ProjectDir* - Specify output project directory
%%
% |''| (default) | 'directoryname' (valid directory name)
%% 
% Use *ProjectDir* to specify output directory for text files, graphical
% representations of moment tensor inversion and other files. Also, the input
% data table (if exists) is copied to this directory after the inversion.
%% 
% *Resample* - Perform additional moment tensor inversions using resampled input datasets
%%
% |[]| (empty array) | |1-by-2| or |1-by-3| or |1-by-4| or |1-by-5| element vector |V|
%%
% The first element |V(1)| of vector |V| specified the number of resamplings of the 
% original input phase dataset. The input data will be randomly resampled 
% |N| times and the inversion will be performed for all randomly resampled datasets
% as well as for the original dataset. This will then result in |N+1| moment tensor
% inversion solutions with the first solution calculated from the unperturbed original 
% dataset and the following solutions calculated from resampled datasets. 
% 
% When |V(2)| is greater than |0|, on average |V(2)*100%| input phase data polarities will be 
% _reversed_ (equivalent of |-rp| option in |focimt| command line application). 
% The typical value of |V(2)| is e.g. 0.03 (which means about 3% of input phase data polarities
% will be reversed).
%
% When |V(3)| is greater than |0|, on average |V(3)*100%| input phase data will be
% _removed_ (equivalent of |-rr| option in |focimt| command line application).
% This option is somehow similar to the *Jacknife Test*, however now more than
% one station may be removed from input phase data, as it is controlled by 
% the |V(3)| parameter. For example, if one want to asses how the removal of 
% up to 5% of input phase data affects the moment tensor inversion results, the
% value of |V(3)| should be 0.05.
% 
% When |V(4)| value is greater than |0|, all input amplitudes in resampled 
% input phase data will be randomly perturbed. Each amplitude of resampled input data 
% is modified using the following formula: $U_i = U_i + N(0,1)*V(4)/3.0$, where
% N(0,1) means a random sample drawn from the Gaussian distribution of 
% mean |0| and standard deviation |1|. Note that the random number drawn is scaled
% by a constant factor of 3.0. The option is equivalent
% to |-ra| option in |focimt| application.
%
% Finally, when |V(5)| parameter is larger than |0|, the input takeoff angle
% data will be randomly biased. Similarly to the _Amplitude Resampling_, the takeoff angle
% of each phase is modified using the following formula: $t_i = t_i + N(0,1)*V(5)/3.0$, where
% N(0,1) means a random sample drawn from Gaussian distribution of 
% mean |0| and standard deviation |1|. The takeoff angle resampling may be 
% used to simulate the uncertainties in the velocity model. The typical values
% should not exceed a couple of degrees. 
%%
% *Solutions* - Type of seismic moment tensor inversions to perform
%%
% |'FTD'| (default) | |'F'| | |'T'| | |'D'| | |'FT'| | |'TD'| | |'FD'|
%%
% By default, three types of seismic moment tensors are calculated: 1) full 
% (unconstrained) moment tensor (character 'F'), deviatoric moment tensor 
% (character 'T') with no volumentric change (i.e. trace = 0) and double-couple
% constrained seismic moment tensor (character 'D'), where both trace and 
% determinant of the tensor are 0. The user may wish to constrain the output
% tensors to only selected MT types to reduce the amount of output data. 
%%
% *StrikeSlipFaultColor* - Color of double-couple line for strike-slip fault
%%
% |1-by-3 vector [R G B]| | |1-by-4 vector [R G B A]|
%%
% Determines color of double-couple lines for strike slip fault. 
% The color vector may be provided either as |1-by-3| element vector containty
% R, G, B intensities (with 0.0 and 1.0 denoting no and full color component 
% intensity, respectively). The alternative option is to provide |1-by-4| 
% element vector where the fourth parameter determines the color 
% transparency (0.0 - full transparent, 1.0 - opaque).
%%
% *ThrustFaultColor* - Color of double-couple line for thrust fault
%%
% |1-by-3 vector [R G B]| | |1-by-4 vector [R G B A]|
%%
% Determines color of double-couple lines for thrust fault. 
% The color vector may be provided either as |1-by-3| element vector containty
% R, G, B intensities (with 0.0 and 1.0 denoting no and full color component 
% intensity, respectively). The alternative option is to provide |1-by-4| 
% element vector where the fourth parameter determines the color 
% transparency (0.0 - full transparent, 1.0 - opaque).
%%
% *TShadingColor* - Color of tension axis shading
%%
% |1-by-3 vector [R G B]| | |1-by-4 vector [R G B A]|
%%
% Determines color of tension axis shading. 
% The color vector may be provided either as |1-by-3| element vector containty
% R, G, B intensities (with 0.0 and 1.0 denoting no and full color component 
% intensity, respectively). The alternative option is to provide |1-by-4| 
% element vector where the fourth parameter determines the color 
% transparency (0.0 - full transparent, 1.0 - opaque).
%%
% *VelocityModel* - Input 1D velocity model 
%%
% |[]| (default) | |n-by-2 matrix|
%%
% Allows to provide a 1D velocity model as |n-by-2| matrix where first
% column corresponds to tops of the lateyers (km) and second column reflects
% layers' widths (km/s). When this parameter is specified it is assumed the
% input file is provided in 1D velocity model format.
%%
% *Verbose* - Display additional output in console window 
%%
% |'off'| (default) | |'on'|
%%
% Turns on/off the display of additional processing information in console
% window. 

%% Examples
%%
% *Example 1*
%%
% Use sample input fociMT file |example1.txt| and perform the seismic 
% moment tensor inversion using default parameters. Then we gather the output data and 
% input data in two cell array structures:
[Output, Input] = focimt('./examples/example1.txt');
Input
Output
%% 
% As the input data contains single seismic event, both |Output| and
% |Input| are cell arrays with only one element corresponding to the 
% processed seismic event. To see the particular seismic moment tensor solution from 
% the particular seismic events, use cell indexing access:
Output{1}
%% 
% The seismic moment tensor solution for a particular event contains in
% fact three types of seismic moment tensors: the full moment tensor, the
% deviatoric (trace-null) moment tensor and the double-couple moment tensor.
% They can be accessible by inspecting |full|, |clvd| and |dc| structures,
% of the cell array element. For example, to see the full moment tensor
% inversion result, you have to access:
Output{1}.full
%%
% The input data originally available inside input file |example1.txt| are interpreted internally in 
% |focimt.m| function and are returned in the second output parameter of the routine:
Input{1}
%% 
% *Example 2*
%%
% We can create a graphical representation of the seismic moment tensor in
% a form of a beach ball plot. In this case, we have to execute |<doc_focimt.html focimt.m>|
% routine with additional properties. For example, the following code will
% perform the moment tensor inversion and three pictures in PNG format will
% be generated:
focimt('./examples/example1.txt','BeachBallFormat','PNG');
%% 
% The code above produce three pictures, one for each type of moment tensor solution:
%
% <<example1_ev01-full.png>>
%
% <<example1_ev01-deviatoric.png>>
%
% <<example1_ev01-dc.png>>
%
%%
% The available formats are PNG, PDF, PS and SVG. The graphical
% representation of the moment tensor solution can be customized using
% different properties: Use _BeachBallSize_ property to generate the picture 
% of the certain size. The _Projection_ parameter controls
% the type of stereonet projection (either equal area or equal angle
% projections is available). Finally, the _Hemisphere_ parameters allows to
% choose between lower (default) or upper hemisphere projection.
% a beach. You can combine the properties to obtain the desired figure shape.
% For example:
focimt('./examples/example1.txt','BeachBallFormat','PDF','Projection','wullf','Hemisphere','upper');
%% 
% will produce the upper hemisphere equal-angle stereonet projection of the
% seismic moment tensor solution in PDF format. 
%%
% *Example 3*
%%
% In this example we perform the seismic moment tensor inversion of two events 
% using Jacknife test to check the stability of both inversions. We export 
% the solution to SVG files and slightly modify the output figure size. Note that 
% the SVG vector format is a convenient way to present your results on web pages, as 
% nowadays it is supported by all web browsers:
focimt('./examples/example2_raw.txt','BeachBallFormat','SVG','BeachBallSize',250,'Jacknife','on');
%%
% The resulting graphical representation of the seismic moment tensor inversion solutions 
% for the first seismic event look as follows:
%
% <<344_014_+165-full.svg>>
%
% <<344_014_+165-deviatoric.svg>>
%
% <<344_014_+165-dc.svg>>
%
%%
% The first seismic moment tensor solution corresponds to the uncostrained (full) 
% moment tensor. The second solution presents the seismic moment tensor that was constrained
% to not to have the volumetric changes (i.e. the trace of the tensor was
% forced to be 0 during inversion). This solution correspond to the seismic moment
% tensor containing only CLVD (compensated linear vector dipole) and DC (double-couple) components. 
% Finally, the last figure presents the DC constrained moment tensor (the determinant and trace of the 
% tensor is kept to be null during inversion).
%%
% The resulting focal mechanisms contains additional nodal lines. Each line
% corresponds to a different moment tensor solution calculated using input data 
% will all but one station. Therefore, in addition to the original seismic moment
% tensor solution, there is |N| more nodal lines where |N| is the number of
% stations (or phases) picked.
%%
% The Jacknife test is useful to determine whether removal of a particular station
% strongly affects the seismic moment tensor inversion results. In this case,
% the particular Jacknife solution will likely differ significantly from the
% remaining ones. This can be a useful test to detect bad stations.
%%
% *Example 4*
%%
% We perform the moment tensor inversion using the built-in 1D velocity model ray-tracer. When
% 1D velocity model and 1D ray-tracer is used, the input data must be provided using different file 
% format. We firstly define the velocity model:
VMODEL = [0.00 3.00 8.00 20.00 22.00; 4.10 5.47 5.75 6.02 7.90]';
%%
% The velocity model matrix is composed of two colums. The elements in the 
% first column correspond to layer tops (in km) and the elements from the second
% column to P-wave velocity (km/s). Once we have the velocity model, we can
% perform the moment tensor inversion:
focimt('./examples/example2_1d.txt','BeachBallFormat','PNG','BeachBallSize',250,'VelocityModel',VMODEL);
%%
% As the input phase data were the same as in example 3 (only the input
% format has changed), the resulting moment tensor solutions are 
% identical:
%
% <<344_014_+165-full.png>>
%
% <<344_014_+165-deviatoric.png>>
%
% <<344_014_+165-dc.png>>
%
% 
%% See also
% |<doc_hybridmt.html hybridmt>| |
% |<doc_readraw.html readraw>| | 
% |<doc_readvel1d.html readvel1d>| |  
% |<matlab:doc('genmt_raw') genmt_raw>| | 
% |<matlab:doc('genmt_vel1d') genmt_vel1d>|





##### SOURCE END #####
--></body></html>